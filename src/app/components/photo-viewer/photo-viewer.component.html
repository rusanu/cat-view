<div class="photo-viewer-container">
  <!-- No Photo Selected -->
  <div *ngIf="!photo" class="no-photo">
    <p class="text-muted">Select a photo to view</p>
  </div>

  <!-- Photo Display -->
  <div *ngIf="photo" class="photo-display">

    <!-- Image -->
    <div class="image-container">
      <button class="photo-nav left" (click)="emitPrevPhoto()"><</button>
      <button class="photo-nav right" (click)="emitNextPhoto()">></button>
      <img [src]="photo.url"
           class="full-image"
           [alt]="photo.fileName"
           class="main-photo"
           [style.transform]="getRotationStyle()">
    </div>

    <div *ngIf="(config.showMetdata$ | async)" class="viewer-toolbar">
      <div class="toolbar-info">
        <strong>{{ photo.fileName }}</strong>
        <span class="text-muted ms-3">{{ formatDateTime(photo.timestamp) }}</span>
      </div>
    </div>

    <!-- Metadata - Always render to prevent layout shift -->
    <div *ngIf="(config.showMetdata$ | async)" class="metadata-bar">
      <div *ngIf="metadata" class="metadata-grid">
        <div class="metadata-item">
          <span class="metadata-label">Temperature:</span>
          <span class="metadata-value">{{ metadata.temperature_celsius }}Â°C</span>
        </div>
        <div class="metadata-item">
          <span class="metadata-label">Humidity:</span>
          <span class="metadata-value">{{ metadata.humidity_percent }}%</span>
        </div>
        <div class="metadata-item">
          <span class="metadata-label">Blanket:</span>
          <span class="metadata-value" [class.status-on]="metadata.blanket_on">
            {{ metadata.blanket_on ? 'ON' : 'OFF' }}
          </span>
        </div>
        <div class="metadata-item">
          <span class="metadata-label">Cat:</span>
          <span class="metadata-value" [class.status-on]="metadata.cat_present">
            {{ metadata.cat_present ? 'Present' : 'Away' }}
          </span>
        </div>
        <div class="metadata-item">
          <span class="metadata-label">Motion:</span>
          <span class="metadata-value">{{ metadata.seconds_since_last_motion }}s ago</span>
        </div>
        <div class="metadata-item">
          <span class="metadata-label">Uptime:</span>
          <span class="metadata-value">{{ formatUptime(metadata.uptime_seconds) }}</span>
        </div>
      </div>
      <span *ngIf="metadataLoading" class="text-muted">Loading metadata...</span>
      <span *ngIf="!metadata && !metadataLoading && photo" class="text-muted">No metadata available</span>
    </div>
  </div>
</div>
